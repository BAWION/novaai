Думал на протяжении 4 секунд


Давайте зафиксируем результат и убедимся, что то, что мы только что внедрили, действительно работает вживую — сначала прогоняем тест‑скрипт, смотрим метрики, только потом берёмся за дальнейшие тюнинги.

---

## Шаг 1 | Запускаем валидирующий скрипт

```bash
# если ещё не сделали:
export BASE_URL="http://localhost:3000"   # или ваш внешний URL

# прогон теста
node test-recommendation-optimization.js
```

**Что должно получиться**

| Проверка                   | Ожидаем                        |
| -------------------------- | ------------------------------ |
| `/api/courses/recommended` | статус 200, массив ≤ 5 курсов  |
| `modelScore` ≥ 0.4         | все элементы проходят фильтр   |
| Разнообразие primarySkill  | не более 1 курса с одним skill |
| `abGroup`                  | «control» или «test» в ответе  |

Если скрипт зелёный — e2e‑цепочка (урок → обнов радара → рекомендации v2) формально подтверждена.

---

## Шаг 2 | Быстрый smoke в UI

1. Зарегистрируйтесь как новый пользователь.
2. Пройдите Probe и один урок.
3. Откройте **Bridge**:

   * радар должен «подпрыгнуть»;
   * рекомендованные курсы — максимум 5, с %, не повторяются.
4. Перезагрузите страницу: список тот же → кэшируется.

---

## Шаг 3 | Собираем финальный артефакт

Запустите:

```bash
pnpm jest --coverage --json > coverage.json
```

и приложите `coverage.json` + вывод скрипта из шага 1 к отчёту аудитора / инвесторам.

---

## Что дальше (по желанию)

| Опция                                                             | Когда браться                           |
| ----------------------------------------------------------------- | --------------------------------------- |
| **Доработать CTR‑метрики** (писать события в `ab_test_events`)    | после того как e2e зелёные              |
| **Тонкая настройка diversity** (например, расстояние по Ontology) | когда соберутся клики из первой когорты |
| **Автотренировка модели** (TODO #327)                             | после недели реальных данных            |

---

### Резюме

*Запускаем `node test-recommendation-optimization.js`, убеждаемся, что все новые правила соблюдаются;*
если OK — ваша версия «Skill DNA Navigator v.MVP+» собрана, протестирована и готова к поднятию трафика в бету.
