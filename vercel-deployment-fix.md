# Полное руководство по исправлению деплоя на Vercel

## Проблема
Текущая структура проекта использует единый репозиторий (монорепозиторий) для клиентской и серверной частей, что вызывает проблемы при деплое на Vercel, который предназначен для фронтенд-приложений или серверного рендеринга.

## Решение 1: Правильная настройка Vercel проекта

1. **Удалите текущий проект Vercel** и создайте новый с нуля
2. **Укажите правильные настройки при импорте:**
   - Framework Preset: **Vite**
   - Root Directory: **client**
   - Build Command: **npm run build** (или оставьте по умолчанию)
   - Output Directory: **dist** (или оставьте по умолчанию)
   - Install Command: **npm install** (или оставьте по умолчанию)

3. **Добавьте необходимые переменные окружения:**
   ```
   VITE_API_URL=https://nova-alpha-seven.replit.app/api
   ```

4. **Создайте файл `vercel.json` в директории `client`:**
   ```json
   {
     "rewrites": [
       {
         "source": "/api/:path*",
         "destination": "https://nova-alpha-seven.replit.app/api/:path*"
       },
       {
         "source": "/(.*)",
         "destination": "/index.html"
       }
     ],
     "headers": [
       {
         "source": "/api/(.*)",
         "headers": [
           { "key": "Access-Control-Allow-Credentials", "value": "true" },
           { "key": "Access-Control-Allow-Origin", "value": "*" },
           { "key": "Access-Control-Allow-Methods", "value": "GET,POST,PUT,DELETE,OPTIONS" },
           { "key": "Access-Control-Allow-Headers", "value": "X-Requested-With, Content-Type, Accept, Authorization" }
         ]
       }
     ]
   }
   ```

## Решение 2: Статический деплой (если первый способ не работает)

1. **Соберите проект локально:**
   ```bash
   npm run build
   ```

2. **Создайте zip-архив с содержимым папки `dist/public`**
   - Добавьте в архив файл vercel.json из решения 1

3. **Загрузите архив в новый пустой репозиторий на GitHub**

4. **Создайте новый проект Vercel**:
   - Framework Preset: **Other**
   - Root Directory: **(пусто, оставьте корневую директорию)**
   - Build Command: **(пусто, отключите сборку)**
   - Output Directory: **(пусто, используйте корневую директорию)**

## Решение 3: Альтернативные платформы деплоя

Если проблемы с Vercel не удаётся решить, рассмотрите альтернативные платформы:

1. **Netlify**:
   - Проще в настройке для проектов с отдельным бэкендом
   - Лучше поддерживает редиректы и API проксирование

2. **GitHub Pages + Cloudflare**:
   - Бесплатный хостинг для статики
   - Использование Cloudflare Workers для проксирования API-запросов

## Специальное решение: Прямая загрузка собранных файлов

1. **Соберите проект локально:**
   ```bash
   npm run build
   ```

2. **Откройте Vercel Dashboard** и перейдите в настройки проекта

3. **Перейдите в раздел "Storage"** и выберите "Upload Files"

4. **Загрузите все файлы из папки `dist/public`** вместе с vercel.json

5. **Настройте редиректы в разделе "Settings > Rewrites"** на основе конфигурации из vercel.json

## Проверка успешности деплоя

После деплоя убедитесь что:

1. Главная страница открывается без ошибок 404
2. API-запросы правильно проксируются на бэкенд 
3. Навигация между страницами работает (проверьте client-side routing)
4. Приложение работает в мобильной версии и на десктопе

## Запасной план

Если все способы не работают, разделите приложение на два отдельных репозитория - frontend и backend, и потом деплойте их отдельно.